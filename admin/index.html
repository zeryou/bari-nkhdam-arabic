<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bari Nkhdam - Jobs</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f7f6; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        h1 { text-align: center; color: #333; }
        
        .job-card { 
            background: white; 
            padding: 20px; 
            margin-bottom: 15px; 
            border-radius: 10px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            transition: transform 0.2s;
        }
        .job-card:hover { transform: translateY(-2px); }
        .job-title { font-size: 1.4em; color: #2c3e50; font-weight: bold; }
        .company { color: #27ae60; font-weight: 600; margin-top: 5px; }
        .city { color: #7f8c8d; font-size: 0.9em; margin-top: 5px; }
        .desc { margin-top: 10px; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸš€ Bari Nkhdam - Ø¢Ø®Ø± Ø§Ù„Ø¹Ø±ÙˆØ¶</h1>
    
    <div id="job-container">
        <p style="text-align:center">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø±ÙˆØ¶...</p>
    </div>
</div>

<script>
    // Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù‡Ù… ÙƒØ§ÙŠÙ† Ù‡Ù†Ø§: Ø²Ø¯Ù†Ø§ "content/" Ù‚Ø¨Ù„ Ø³Ù…ÙŠØ© Ø§Ù„Ù…Ù„Ù
    fetch('content/data.json') 
        .then(response => {
            if (!response.ok) {
                // Ø¥ÙŠÙ„Ø§ Ù…Ø§Ù„Ù‚Ø§Ø´ Ø§Ù„Ù…Ù„ÙØŒ ØºØ§ÙŠØ¹Ø·ÙŠÙ†Ø§ 404
                throw new Error("Ø§Ù„Ù…Ù„Ù content/data.json Ù…Ø§ ÙƒØ§ÙŠÙ†Ø´ (404)");
            }
            return response.json();
        })
        .then(data => {
            const container = document.getElementById('job-container');
            container.innerHTML = ''; // Ø®ÙˆÙŠ Ø§Ù„Ù…ÙŠØ³Ø§Ø¬ Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„

            // ØªØ£ÙƒØ¯ ÙˆØ§Ø´ ÙƒØ§ÙŠÙ†ÙŠÙ† Jobs ÙØ§Ù„Ù…Ù„Ù
            if (!data.jobs || data.jobs.length === 0) {
                container.innerHTML = '<p style="text-align:center">Ù…Ø§ ÙƒØ§ÙŠÙ†Ø§ Ø­ØªÙ‰ Ø®Ø¯Ù…Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</p>';
                return;
            }

            // Ø±Ø³Ù… Ø§Ù„Ø¹Ø±ÙˆØ¶
            data.jobs.forEach(job => {
                const card = document.createElement('div');
                card.className = 'job-card';
                card.innerHTML = `
                    <div class="job-title">${job.title}</div>
                    <div class="company">ğŸ¢ ${job.company}</div>
                    <div class="city">ğŸ“ ${job.city}</div>
                    <div class="desc">${job.body ? job.body.substring(0, 150) + '...' : ''}</div>
                `;
                container.appendChild(card);
            });
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('job-container').innerHTML = 
                '<p style="text-align:center; color:red;">âš ï¸ Ù…Ø´ÙƒÙ„: ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ø¯Ø±ØªÙŠ Publish Ù…Ù† Admin Ø¨Ø§Ø´ ÙŠØªÙƒØ±ÙŠØ§ Ù…Ù„Ù content/data.json</p>';
        });

    // ÙƒÙˆØ¯ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù€ Admin
    if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", user => {
            if (!user) {
                window.netlifyIdentity.on("login", () => {
                    document.location.href = "/admin/";
                });
            }
        });
    }
</script>

</body>
</html>
